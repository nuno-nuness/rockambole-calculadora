<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Casa Rockambole — Calculadora de Orçamento</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <meta name="description" content="Monte seu orçamento de evento corporativo na Casa Rockambole em poucos passos."/>
  <style>
    :root {
      --rock-lime: #dce293; /* cor da referência enviada */
    }
    .soft-card { border-radius: 1.25rem; box-shadow: 0 10px 30px rgba(0,0,0,.08); }
    .graphic-bg {
      position: relative;
      overflow: hidden;
    }
    .graphic-bg::before, .graphic-bg::after {
      content: "";
      position: absolute; inset: -10% -10% auto -10%;
      height: 65vh; pointer-events: none; z-index: 0;
      background:
        radial-gradient(1200px 500px at -10% 30%, rgba(255,255,255,.45), transparent 60%),
        radial-gradient(900px 400px at 110% 70%, rgba(255,255,255,.35), transparent 55%),
        radial-gradient(600px 240px at 40% -10%, rgba(255,255,255,.25), transparent 60%);
      filter: blur(0.2px);
    }
    .graphic-bg::after { top: 40vh; height: 80vh; opacity: .6; }
  </style>
</head>
<body class="min-h-screen bg-[var(--rock-lime)] text-stone-900 graphic-bg">
  <div class="relative z-10 max-w-6xl mx-auto p-4 sm:p-6">
    <header class="mb-6 text-center flex flex-col items-center gap-3">
      <img src="logo-casa.png" alt="Logo Casa Rockambole" class="h-16 sm:h-20 drop-shadow"/>
      <div class="inline-block bg-white/70 backdrop-blur-sm px-4 py-2 rounded-full text-xs tracking-wide text-stone-700 shadow">Calculadora de Orçamento</div>
      <h1 class="mt-2 text-3xl sm:text-5xl font-bold leading-tight">Casa Rockambole</h1>
      <p class="mt-2 text-stone-700 text-sm sm:text-base max-w-2xl">Monte uma estimativa instantânea. Valores indicativos, sujeitos a disponibilidade e visita técnica.</p>
    </header>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
      <!-- Inputs -->
      <section class="soft-card bg-white p-5">
        <h2 class="text-xl font-semibold mb-4">1) Dados do evento</h2>
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
          <label class="block">
            <span class="text-sm">Data</span>
            <input id="date" type="date" class="mt-1 w-full rounded-xl border p-2"/>
          </label>
          <label class="block">
            <span class="text-sm">Dia da semana</span>
            <select id="weekday" class="mt-1 w-full rounded-xl border p-2">
              <option value="auto">Detectar pela data</option>
              <option value="segqui">Seg, Ter, Qua, Qui ou Dom</option>
              <option value="sefsab">Sexta ou Sábado</option>
            </select>
          </label>
          <label class="block">
            <span class="text-sm">Horário (início)</span>
            <input id="start" type="time" value="18:00" class="mt-1 w-full rounded-xl border p-2"/>
          </label>
          <label class="block">
            <span class="text-sm">Duração (horas)</span>
            <input id="hours" type="number" min="1" max="12" value="6" class="mt-1 w-full rounded-xl border p-2"/>
          </label>
          <label class="block sm:col-span-2">
            <span class="text-sm">Qtd. de convidados</span>
            <input id="guests" type="number" min="10" value="200" class="mt-1 w-full rounded-xl border p-2"/>
          </label>
        </div>

        <hr class="my-5"/>

        <h2 class="text-xl font-semibold mb-3">2) Espaço</h2>
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
          <label class="flex items-center gap-2 border rounded-xl p-3 cursor-pointer">
            <input type="radio" name="space" value="cp" class="accent-black" checked>
            <div>
              <div class="font-medium">Coreto + Pistinha</div>
              <div class="text-xs text-stone-500">até ~200 pessoas</div>
            </div>
          </label>
          <label class="flex items-center gap-2 border rounded-xl p-3 cursor-pointer">
            <input type="radio" name="space" value="ct" class="accent-black">
            <div>
              <div class="font-medium">Coreto + Teatro</div>
              <div class="text-xs text-stone-500">até ~450 pessoas</div>
            </div>
          </label>
          <label class="flex items-center gap-2 border rounded-xl p-3 cursor-pointer sm:col-span-2">
            <input type="radio" name="space" value="casa" class="accent-black">
            <div>
              <div class="font-medium">Casa Toda (2 pistas) <span class="text-xs text-stone-500">(exceto estúdio e escritório)</span></div>
              <div class="text-xs text-stone-500">até ~600 pessoas</div>
            </div>
          </label>
        </div>
        <p class="mt-2 text-xs text-stone-600">Diárias de montagem: 60% do valor de uma diária padrão.</p>

        <hr class="my-5"/>

        <h2 class="text-xl font-semibold mb-3">3) Bar e Alimentação</h2>
        <div class="space-y-3">
          <label class="block">
            <span class="text-sm">Bar</span>
            <select id="barType" class="mt-1 w-full rounded-xl border p-2">
              <option value="vendas">Bar da casa (venda no consumo, sem custo)</option>
              <option value="open">Open bar da casa (escolher opção)</option>
              <option value="externo">Bar externo (taxa de liberação)</option>
            </select>
          </label>

          <div id="openBarBlock" class="grid grid-cols-1 sm:grid-cols-2 gap-3 hidden">
            <label class="block sm:col-span-2">
              <span class="text-sm">Opção de open bar</span>
              <select id="openBarOption" class="mt-1 w-full rounded-xl border p-2">
                <option value="essencial" data-pp="65.9">Essencial — R$65,90 p/p (Amstel, Gin Tônica, Caipirinha de Limão)</option>
                <option value="classico" data-pp="85.5">Clássico — R$85,50 p/p (Heineken, Negroni, Aperol Spritz)</option>
                <option value="especial" data-pp="97.5">Especial — R$97,50 p/p (Drink autoral batizado para a empresa)</option>
              </select>
            </label>
            <details class="sm:col-span-2 text-sm text-stone-600">
              <summary class="cursor-pointer">Detalhes dos planos</summary>
              <p><strong>Essencial:</strong> Cerveja Amstel, água, refrigerantes, gin tônica, caipirinha de limão.</p>
              <p><strong>Clássico:</strong> Inclui Heineken, Negroni, Aperol Spritz além do Essencial.</p>
              <p><strong>Especial:</strong> Tudo do Clássico + 1 drink autoral criado para a empresa/evento.</p>
            </details>
          </div>

          <div id="barExternoBlock" class="hidden">
            <label class="block">
              <span class="text-sm">Taxa de liberação do bar externo (R$)</span>
              <input id="barFee" type="number" step="1" value="3000" class="mt-1 w-full rounded-xl border p-2"/>
            </label>
          </div>

          <label class="block">
            <span class="text-sm">Open food</span>
            <select id="openFoodOption" class="mt-1 w-full rounded-xl border p-2">
              <option value="pizza" data-pp="89">Festival de Massas/Rodízio de Pizza — R$89,00 p/p</option>
              <option value="finger" data-pp="130">Finger Foods — R$130,00 p/p</option>
              <option value="gourmet" data-pp="150">Gourmet — R$150,00 p/p (finger refinado + pratos quentes)</option>
            </select>
          </label>
          <details class="text-sm text-stone-600">
            <summary class="cursor-pointer">Detalhes dos planos</summary>
            <p><strong>Festival de Massas/Rodízio de Pizza:</strong> menu de pizzas artesanais ou buffet de massas (molhos, acompanhamentos, saladas).</p>
            <p><strong>Finger Foods:</strong> coquetel volante com seleção variada de canapés frios, quentes e opções doces.</p>
            <p><strong>Gourmet:</strong> finger refinado + pratos quentes de alta gastronomia, servido por garçons.</p>
          </details>
        </div>

        <hr class="my-5"/>

        <h2 class="text-xl font-semibold mb-3">4) Extras</h2>
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
          <label class="flex items-center gap-2 border rounded-xl p-3">
            <input type="checkbox" id="dj" class="accent-black"> DJ — R$ 1.500
          </label>
          <label class="flex items-center gap-2 border rounded-xl p-3">
            <input type="checkbox" id="cabine" class="accent-black"> Cabine de fotos — R$ 2.800
          </label>
          <label class="flex items-center gap-2 border rounded-xl p-3">
            <input type="checkbox" id="projetor" class="accent-black"> Projetor + Telão + Notebook — R$ 1.300
          </label>
          <label class="flex items-center gap-2 border rounded-xl p-3">
            <input type="checkbox" id="cafe4" class="accent-black"> Mesa de Café (4h) — R$ 8.000
          </label>
          <label class="flex items-center gap-2 border rounded-xl p-3">
            <input type="checkbox" id="cafe8" class="accent-black"> Mesa de Café (8h) — R$ 9.500
          </label>
        </div>
        <p class="mt-4 text-xs text-stone-600">Gerador em standby incluso quando especificado na proposta. Rider completo disponível sob solicitação.</p>
      </section>

      <!-- Summary -->
      <section class="soft-card bg-white p-5 lg:sticky lg:top-4">
        <h2 class="text-xl font-semibold mb-4">Resumo</h2>
        <div id="summary" class="space-y-2 text-sm"></div>
        <div class="border-t my-4"></div>
        <div class="flex items-end justify-between">
          <div>
            <div class="text-xs text-stone-500">Valor por pessoa (estimativa)</div>
            <div class="text-2xl font-bold">R$ <span id="pp">0,00</span></div>
          </div>
          <div class="text-right">
            <div class="text-xs text-stone-500">Total estimado</div>
            <div class="text-3xl font-extrabold">R$ <span id="total">0,00</span></div>
          </div>
        </div>
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 mt-6">
          <button id="copyBtn" class="rounded-2xl px-4 py-3 bg-stone-900 text-white hover:opacity-90">Copiar orçamento</button>
          <button id="waBtn" class="rounded-2xl px-4 py-3 border">Enviar por WhatsApp</button>
        </div>
        <p class="text-xs text-stone-500 mt-4">Condição de pagamento sugerida: 30% de entrada e 70% até o dia do evento. Valores indicativos, sujeitos a disponibilidade e visita técnica.</p>
      </section>
    </div>

    <footer class="text-xs text-stone-700 mt-8 text-center">© Casa Rockambole — Pinheiros, São Paulo</footer>
  </div>

  <script>
    const PRICES = {
      segqui: { cp: 10000, ct: 12000, casa: 17000 },
      sefsab: { cp: 12000, ct: 15000, casa: 20000 }
    };

    const EXTRAS = {
      dj: 1500,
      cabine: 2800,
      projetor: 1300,
      cafe4: 8000,
      cafe8: 9500
    };

    const el = (id) => document.getElementById(id);

    function detectWeekGroup(dateStr) {
      if (!dateStr) return 'segqui';
      const d = new Date(dateStr + 'T12:00:00');
      const day = d.getUTCDay(); // 0=Dom, 5=Sex, 6=Sáb
      if (day === 5 || day === 6) return 'sefsab';
      return 'segqui';
    }

    function fmtBRL(n) {
      return n.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
    }

    function currentSpace() {
      const sel = document.querySelector('input[name="space"]:checked');
      return sel ? sel.value : 'cp';
    }

    function calc() {
      const guests = Math.max(1, Number(el('guests').value || 0));
      const weekSel = el('weekday').value === 'auto' ? detectWeekGroup(el('date').value) : el('weekday').value;
      const space = currentSpace();
      const locacao = PRICES[weekSel][space];

      let barDesc = '';
      let barTotal = 0;
      if (el('barType').value === 'open') {
        const opt = el('openBarOption');
        const pp = Number(opt.options[opt.selectedIndex].dataset.pp);
        barTotal = pp * guests;
        barDesc = `Open bar — ${opt.options[opt.selectedIndex].text} (${guests} x R$ ${fmtBRL(pp)})`;
      } else if (el('barType').value === 'externo') {
        const fee = Number(el('barFee').value || 0);
        barTotal = fee;
        barDesc = `Bar externo (taxa de liberação)`;
      } else {
        barDesc = 'Bar da casa (venda no consumo)';
      }

      const foodOpt = el('openFoodOption');
      const foodPp = Number(foodOpt.options[foodOpt.selectedIndex].dataset.pp);
      const foodTotal = foodPp * guests;

      const extras = [];
      let extrasTotal = 0;
      for (const key of Object.keys(EXTRAS)) {
        if (el(key).checked) {
          extras.push([key, EXTRAS[key]]);
          extrasTotal += EXTRAS[key];
        }
      }

      const total = locacao + barTotal + foodTotal + extrasTotal;
      const perPerson = total / guests;

      const res = [];
      const spaceNames = { cp: 'Coreto + Pistinha', ct: 'Coreto + Teatro', casa: 'Casa Toda (2 pistas) — (exceto estúdio e escritório)' };
      const weekNames = { segqui: 'Seg/Qui/Dom', sefsab: 'Sex/Sáb' };
      res.push(`<div><strong>Espaço:</strong> ${spaceNames[space]} — <span class="text-stone-500">${weekNames[weekSel]}</span> <span class="float-right font-medium">R$ ${fmtBRL(locacao)}</span></div>`);
      res.push(`<div><strong>Bar:</strong> ${barDesc} <span class="float-right font-medium">R$ ${fmtBRL(barTotal)}</span></div>`);
      res.push(`<div><strong>Open food:</strong> ${foodOpt.options[foodOpt.selectedIndex].text} (${guests} x R$ ${fmtBRL(foodPp)}) <span class="float-right font-medium">R$ ${fmtBRL(foodTotal)}</span></div>`);

      const labels = { dj: 'DJ', cabine: 'Cabine de fotos', projetor: 'Projetor + Telão + Notebook', cafe4: 'Mesa de Café (4h)', cafe8: 'Mesa de Café (8h)' };
      if (extrasTotal) {
        res.push('<div class="mt-2 font-medium">Extras:</div>');
        Object.keys(EXTRAS).forEach((k)=>{
          if (el(k).checked) res.push(`<div class=\"pl-3 flex justify-between\"><span>• ${labels[k]}</span><span class=\"font-medium\">R$ ${fmtBRL(EXTRAS[k])}</span></div>`);
        });
      }

      el('summary').innerHTML = res.join('');
      el('total').textContent = fmtBRL(total);
      el('pp').textContent = fmtBRL(perPerson);

      return { total, perPerson, locacao, barTotal, foodTotal, extrasTotal, guests, weekSel, space };
    }

    function toggleBlocks() {
      const type = el('barType').value;
      el('openBarBlock').classList.toggle('hidden', type !== 'open');
      el('barExternoBlock').classList.toggle('hidden', type !== 'externo');
    }

    function buildText() {
      const d = calc();
      const labels = { cp: 'Coreto + Pistinha', ct: 'Coreto + Teatro', casa: 'Casa Toda (2 pistas) — (exceto estúdio e escritório)' };
      const week = { segqui: 'Seg/Qui/Dom', sefsab: 'Sex/Sáb' }[d.weekSel];
      const date = el('date').value ? new Date(el('date').value + 'T12:00:00').toLocaleDateString('pt-BR') : '(data a confirmar)';

      const foodOpt = el('openFoodOption');
      const foodLabel = foodOpt.options[foodOpt.selectedIndex].text;

      let text = `Orçamento Estimado — Casa Rockambole%0A`;
      text += `Data: ${date} | Início: ${el('start').value} | Duração: ${el('hours').value}h%0A`;
      text += `Convidados: ${Number(el('guests').value || 0)}%0A`;
      text += `Espaço: ${labels[document.querySelector('input[name="space"]:checked').value]} (${week})%0A`;
      text += `------------------------------------%0A`;
      text += `Locação: R$ ${fmtBRL(d.locacao)}%0A`;

      const barType = el('barType').value;
      if (barType === 'open') {
        const opt = el('openBarOption');
        text += `Bar: Open bar — ${opt.options[opt.selectedIndex].text} — R$ ${fmtBRL(d.barTotal)}%0A`;
      } else if (barType === 'externo') {
        text += `Bar: Externo (taxa de liberação) — R$ ${fmtBRL(d.barTotal)}%0A`;
      } else {
        text += `Bar: Consumo (sem custo) — R$ 0,00%0A`;
      }

      text += `Open food: ${foodLabel} — R$ ${fmtBRL(d.foodTotal)}%0A`;
      text += `------------------------------------%0A`;
      text += `Total estimado: R$ ${fmtBRL(d.total)}%0A`;
      text += `Valor por pessoa: R$ ${fmtBRL(d.perPerson)}%0A%0A`;
      text += `Condição sugerida: 30% de entrada e 70% até o dia do evento.%0A`;
      text += `*Observações:* valores indicativos, sujeitos a disponibilidade de data e visita técnica.`;
      return text;
    }

    function copyToClipboard() {
      const plain = decodeURIComponent(buildText().replace(/%0A/g, '\n'));
      navigator.clipboard.writeText(plain).then(() => { alert('Orçamento copiado!'); });
    }
    function openWhatsApp() {
      const text = buildText();
      const url = `https://wa.me/?text=${text}`;
      window.open(url, '_blank');
    }

    // Bindings
    ['date','weekday','start','hours','guests','barType','openBarOption','barFee','openFoodOption'].forEach(id => {
      const node = el(id);
      if (node) {
        node.addEventListener('input', () => { toggleBlocks(); calc(); });
        node.addEventListener('change', () => { toggleBlocks(); calc(); });
      }
    });
    document.querySelectorAll('input[name="space"]').forEach(r => r.addEventListener('change', calc));
    ;['dj','cabine','projetor','cafe4','cafe8'].forEach(id => { const n = el(id); if(n){ n.addEventListener('change', calc);} });
    document.addEventListener('click', (e)=>{
      if(e.target && e.target.id==='copyBtn') copyToClipboard();
      if(e.target && e.target.id==='waBtn') openWhatsApp();
    });

    // init
    toggleBlocks();
    calc();
  </script>
</body>
</html>
